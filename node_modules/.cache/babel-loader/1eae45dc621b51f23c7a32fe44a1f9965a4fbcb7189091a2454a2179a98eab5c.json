{"ast":null,"code":"import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from 'firebase/storage';\nimport { collection, addDoc } from 'firebase/firestore';\nimport firebase from 'firebase/app';\nimport { db } from \"/src/firebase/index.js\"; // adjust the path according to your project structure\n\nexport default {\n  data() {\n    return {\n      tweetContent: \"\",\n      tweetImage: null\n    };\n  },\n  methods: {\n    async postTweet() {\n      try {\n        const user = firebase.auth().currentUser;\n        if (!user) throw new Error(\"User not authenticated\");\n        let imageUrl = null;\n        if (this.tweetImage) {\n          const storage = getStorage();\n          const imageRef = storageRef(storage, 'tweets/' + this.tweetImage.name);\n          await uploadBytes(imageRef, this.tweetImage);\n          imageUrl = await getDownloadURL(imageRef);\n        }\n        await this.createTweet(this.tweetContent, user, imageUrl);\n        this.tweetContent = \"\"; // clear the textarea after posting\n        this.tweetImage = null;\n        this.$emit('tweetPosted');\n        this.fetchTweets();\n      } catch (error) {\n        console.error(\"Error posting tweet:\", error);\n      }\n    },\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.tweetImage = file;\n      }\n    },\n    async createTweet(content, user, imageUrl = null) {\n      const tweet = {\n        content: content,\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n        userId: user.uid,\n        username: user.displayName || user.email,\n        // fallback to email if displayName doesn't exist\n        profileImage: user.profileImage,\n        imageUrl: imageUrl // Include the image URL if it exists\n      };\n\n      const tweetsCollection = collection(db, \"tweets\");\n      await addDoc(tweetsCollection, tweet);\n    }\n  }\n};","map":{"version":3,"names":["getStorage","ref","storageRef","uploadBytes","getDownloadURL","collection","addDoc","firebase","db","data","tweetContent","tweetImage","methods","postTweet","user","auth","currentUser","Error","imageUrl","storage","imageRef","name","createTweet","$emit","fetchTweets","error","console","onFileChange","e","file","target","files","content","tweet","timestamp","firestore","FieldValue","serverTimestamp","userId","uid","username","displayName","email","profileImage","tweetsCollection"],"sources":["/Users/kharelthompson/Coding/tc23/src/components/TweetBox.vue"],"sourcesContent":["<template>\n<v-row>\n    <!-- This column will take the majority of the space -->\n    <v-col cols=\"12\">\n      <v-textarea v-model=\"tweetContent\" placeholder=\"What is happening?!\"></v-textarea>\n       </v-col>\n       </v-row>\n   \n       <v-row>\n       <v-col cols=\"10\">\n      <!-- Upload icon triggering the file input -->\n      <label>\n        <v-icon>mdi-image</v-icon>\n        <input type=\"file\" @change=\"onFileChange\" style=\"display: none;\">\n      </label>\n    </v-col>\n    \n    <!-- This column will be for the Post button -->\n    <v-col cols=\"1\" class=\"text-end\">\n      <v-btn @click=\"postTweet\">Post</v-btn>\n    </v-col>\n  </v-row>\n</template>\n\n\n<script>\nimport { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from 'firebase/storage';\nimport { collection, addDoc } from 'firebase/firestore';\nimport firebase from 'firebase/app';\nimport { db } from \"/src/firebase/index.js\"; // adjust the path according to your project structure\n\nexport default {\n  data() {\n    return {\n      tweetContent: \"\",\n      tweetImage: null,\n    };\n  },\n  methods: { \n    async postTweet() {\n      try {\n        const user = firebase.auth().currentUser;\n        if (!user) throw new Error(\"User not authenticated\");\n\n        let imageUrl = null;\n        if (this.tweetImage) {\n          const storage = getStorage();\n          const imageRef = storageRef(storage, 'tweets/' + this.tweetImage.name);\n          await uploadBytes(imageRef, this.tweetImage);\n          imageUrl = await getDownloadURL(imageRef);\n        }\n        \n        await this.createTweet(this.tweetContent, user, imageUrl);\n        this.tweetContent = \"\"; // clear the textarea after posting\n        this.tweetImage = null;\n        this.$emit('tweetPosted');\n        this.fetchTweets(); \n      } catch (error) {\n        console.error(\"Error posting tweet:\", error);\n      }\n    },\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.tweetImage = file;\n      }\n    },\n    async createTweet(content, user, imageUrl = null) {\n      const tweet = {\n        content: content,\n        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n        userId: user.uid,\n        username: user.displayName || user.email, // fallback to email if displayName doesn't exist\n        profileImage: user.profileImage, \n        imageUrl: imageUrl, // Include the image URL if it exists\n      };\n\n      const tweetsCollection = collection(db, \"tweets\");\n      await addDoc(tweetsCollection, tweet);\n    }\n  }\n};\n</script>"],"mappings":"AA0BA,SAASA,UAAU,EAAEC,GAAE,IAAKC,UAAU,EAAEC,WAAW,EAAEC,cAAa,QAAS,kBAAkB;AAC7F,SAASC,UAAU,EAAEC,MAAK,QAAS,oBAAoB;AACvD,OAAOC,QAAO,MAAO,cAAc;AACnC,SAASC,EAAC,QAAS,wBAAwB,EAAE;;AAE7C,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,YAAY,EAAE,EAAE;MAChBC,UAAU,EAAE;IACd,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,SAASA,CAAA,EAAG;MAChB,IAAI;QACF,MAAMC,IAAG,GAAIP,QAAQ,CAACQ,IAAI,CAAC,CAAC,CAACC,WAAW;QACxC,IAAI,CAACF,IAAI,EAAE,MAAM,IAAIG,KAAK,CAAC,wBAAwB,CAAC;QAEpD,IAAIC,QAAO,GAAI,IAAI;QACnB,IAAI,IAAI,CAACP,UAAU,EAAE;UACnB,MAAMQ,OAAM,GAAInB,UAAU,CAAC,CAAC;UAC5B,MAAMoB,QAAO,GAAIlB,UAAU,CAACiB,OAAO,EAAE,SAAQ,GAAI,IAAI,CAACR,UAAU,CAACU,IAAI,CAAC;UACtE,MAAMlB,WAAW,CAACiB,QAAQ,EAAE,IAAI,CAACT,UAAU,CAAC;UAC5CO,QAAO,GAAI,MAAMd,cAAc,CAACgB,QAAQ,CAAC;QAC3C;QAEA,MAAM,IAAI,CAACE,WAAW,CAAC,IAAI,CAACZ,YAAY,EAAEI,IAAI,EAAEI,QAAQ,CAAC;QACzD,IAAI,CAACR,YAAW,GAAI,EAAE,EAAE;QACxB,IAAI,CAACC,UAAS,GAAI,IAAI;QACtB,IAAI,CAACY,KAAK,CAAC,aAAa,CAAC;QACzB,IAAI,CAACC,WAAW,CAAC,CAAC;MACpB,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC9C;IACF,CAAC;IACDE,YAAYA,CAACC,CAAC,EAAE;MACd,MAAMC,IAAG,GAAID,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAC9B,IAAIF,IAAI,EAAE;QACR,IAAI,CAAClB,UAAS,GAAIkB,IAAI;MACxB;IACF,CAAC;IACD,MAAMP,WAAWA,CAACU,OAAO,EAAElB,IAAI,EAAEI,QAAO,GAAI,IAAI,EAAE;MAChD,MAAMe,KAAI,GAAI;QACZD,OAAO,EAAEA,OAAO;QAChBE,SAAS,EAAE3B,QAAQ,CAAC4B,SAAS,CAACC,UAAU,CAACC,eAAe,CAAC,CAAC;QAC1DC,MAAM,EAAExB,IAAI,CAACyB,GAAG;QAChBC,QAAQ,EAAE1B,IAAI,CAAC2B,WAAU,IAAK3B,IAAI,CAAC4B,KAAK;QAAE;QAC1CC,YAAY,EAAE7B,IAAI,CAAC6B,YAAY;QAC/BzB,QAAQ,EAAEA,QAAQ,CAAE;MACtB,CAAC;;MAED,MAAM0B,gBAAe,GAAIvC,UAAU,CAACG,EAAE,EAAE,QAAQ,CAAC;MACjD,MAAMF,MAAM,CAACsC,gBAAgB,EAAEX,KAAK,CAAC;IACvC;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}